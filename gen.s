; generated by baz

section .data
;[15:1] field hello="hello world\n" 
hello db 'hello world',10,''
hello.len equ $-hello
;[16:1] field one="one\n" 
one db 'one',10,''
one.len equ $-one
;[17:1] field num=4 
num dd 4

section .bss
stk resd 256
stk.end:

section .text
bits 32
align 4
global _start
_start:
mov ebp,stk
mov esp,stk.end
;  [20:5] print(hello.len,hello)
;    [8:5] mov(ecx,ptr)
     mov ecx,hello
;    [9:5] mov(edx,len)
     mov edx,hello.len
;    [10:5] mov(ebx,1)
     mov ebx,1
;    [11:5] mov(eax,4)
     mov eax,4
;    [12:5] int(0x80)
     int 0x80
   print_20_5_end:
;  [21:5] var a=1 
;  [21:9] a=1 
;  [21:11] 1 
;  [21:11] a=1 
   mov dword[ebp+0],1
;  [22:5] var b=2 
;  [22:9] b=2 
;  [22:11] 2 
;  [22:11] b=2 
   mov dword[ebp+4],2
;  [23:5] var c=3 
;  [23:9] c=3 
;  [23:11] 3 
;  [23:11] c=3 
   mov dword[ebp+8],3
;  [24:5] var d=4 
;  [24:9] d=4 
;  [24:11] 4 
;  [24:11] d=4 
   mov dword[ebp+12],4
;  [25:5] var n=10 
;  [25:9] n=10 
;  [25:11] 10 
;  [25:11] n=10 
   mov dword[ebp+16],10
;  [26:5] loop
   loop_26_5:
     if_27_10:
;    [27:10] ? n=0 
;    [27:10] ? n=0 
     cmp_27_10:
     cmp dword[ebp+16],0
     jne if_27_7_end
     if_27_10_code:  ; opt1
;      [27:14] break 
       jmp loop_26_5_end
     if_27_7_end:
;    [28:7] var r=((a+b)*c+d)*2 
;    [28:11] r=((a+b)*c+d)*2 
;    [28:13] ((a+b)*c+d)*2 
;    [28:14] edi=((a+b)*c+d)
;    [28:14] ((a+b)*c+d)
;    [28:15] edi=(a+b)
;    [28:15] (a+b)
;    [28:15] edi=a
     mov edi,dword[ebp+0]
;    [28:17] edi+b
     add edi,dword[ebp+4]
;    [28:20] edi*c
     imul edi,dword[ebp+8]
;    [28:22] edi+d
     add edi,dword[ebp+12]
;    [28:25] edi*2 
     imul edi,2
     mov dword[ebp+20],edi
;    [29:7] n=n-1 
;    [29:9] n-1 
;    [29:9] n=n
;    [29:11] n-1 
     sub dword[ebp+16],1
     if_30_10:
;    [30:10] ? not n=1 
;    [30:10] ? not n=1 
     cmp_30_10:
     cmp dword[ebp+16],1
     je if_30_7_end
     if_30_10_code:  ; opt1
;      [30:18] continue 
       jmp loop_26_5
     if_30_7_end:
;    [31:7] print(num,one)
;      [8:5] mov(ecx,ptr)
       mov ecx,one
;      [9:5] mov(edx,len)
       mov edx,dword[num]
;      [10:5] mov(ebx,1)
       mov ebx,1
;      [11:5] mov(eax,4)
       mov eax,4
;      [12:5] int(0x80)
       int 0x80
     print_31_7_end:
   jmp loop_26_5
   loop_26_5_end:
;  [33:5] exit(0)
;    [2:5] mov(ebx,v)
     mov ebx,0
;    [3:5] mov(eax,1)
     mov eax,1
;    [4:5] int(0x80)
     int 0x80
   exit_33_5_end:

;           max regs in use: 1
;         max frames in use: 3
;          max stack in use: 6

