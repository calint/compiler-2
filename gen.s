; generated by baz

section .data
align 4
;[1:1] field name="............................................................" 
name db '............................................................'
name.len equ $-name

section .bss
align 4
stk resd 256
stk.end:

section .text
align 4
bits 64
global _start
_start:
mov rsp,stk.end
mov rbp,rsp
jmp main

main:
;  [27:5] var len=read(name.len,name)-1 
;  len: qword[rbp-8]
;  [27:9] len=read(name.len,name)-1 
;  [27:13] read(name.len,name)-1 
;  [27:13] len=read(name.len,name)
;  [27:13] read(name.len,name)
;  read(len:reg_rdx,ptr:reg_rsi):nbytes_read 
;    inline: 27_13
;    alias nbytes_read -> len
;    alloc rdx
;    alias len -> rdx
     mov rdx,name.len
;    alloc rsi
;    alias ptr -> rsi
     mov rsi,name
;    [12:5] mov(rax,3)
     mov rax,3
;    [12:18] # read system call 
;    [13:5] mov(rbx,0)
     mov rbx,0
;    [13:18] # file descriptor for standard input 
;    [14:5] mov(rcx,ptr)
     mov rcx,rsi
;    [14:18] # buffer address 
;    [15:5] mov(rdx,len)
;    [15:18] # buffer size 
;    [16:5] int(0x80)
     int 0x80
;    [17:5] mov(nbytes_read,rax)
     mov qword[rbp-8],rax
;    free rsi
;    free rdx
   read_27_13_end:
;  [27:33] len-1 
   sub qword[rbp-8],1
;  [27:35] # remove the \n 
;  [28:5] print(len,name)
;  print(len:reg_rdx,ptr:reg_rcx) 
;    inline: 28_5
;    alloc rdx
;    alias len -> rdx
     mov rdx,qword[rbp-8]
;    alloc rcx
;    alias ptr -> rcx
     mov rcx,name
;    [4:5] mov(rax,4)
     mov rax,4
;    [4:18] # write system call 
;    [5:5] mov(rbx,1)
     mov rbx,1
;    [5:18] # file descriptor for standard out 
;    [6:5] mov(rcx,ptr)
;    [6:18] # buffer address 
;    [7:5] mov(rdx,len)
;    [7:18] # buffer size 
;    [8:5] int(0x80)
     int 0x80
;    free rcx
;    free rdx
   print_28_5_end:
;  [29:5] exit(0)
;  exit(v) 
;    inline: 29_5
;    alias v -> 0
;    [21:5] mov(rbx,v)
     mov rbx,0
;    [22:5] mov(rax,1)
     mov rax,1
;    [23:5] int(0x80)
     int 0x80
   exit_29_5_end:

; max scratch registers in use: 1
;            max frames in use: 4

