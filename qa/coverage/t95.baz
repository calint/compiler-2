func exit(v : reg_rdi) {
    mov(rax, 60)  # exit system call
    mov(rdi, v)   # return code
    syscall()
}

func assert(expr : bool) {
    if not expr exit(1)
}

func main() {
    var i = 2
    assert(i == 2)
    
    var j = 3
    assert(j == 3)

    {
        var i = 4
        assert(i == 4)
        assert(j == 3)
    }

    assert(i == 2)
    assert(j == 3)
}
